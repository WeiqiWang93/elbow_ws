\hypertarget{autotoc_md6_autotoc_md7}{}\doxysection{made by Off\+World Inc. (www.\+offworld.\+ai)}\label{autotoc_md6_autotoc_md7}
\hypertarget{autotoc_md6_autotoc_md8}{}\doxysubsection{How To\+: auto calibrate cameras with respect to arm base}\label{autotoc_md6_autotoc_md8}
\hypertarget{autotoc_md6_autotoc_md9}{}\doxysubsubsection{Steps\+:}\label{autotoc_md6_autotoc_md9}

\begin{DoxyItemize}
\item Powering chisel/saw arm \textbackslash{}
\begin{DoxyEnumerate}
\item Turn red knob to on position.\textbackslash{}
\item Turn on inverter switch (about 2 inches below O\+BP power button).\textbackslash{}
\item Press green button on UR 10 box (wait for sound).
\end{DoxyEnumerate}
\item Connecting to chisel bot\+:\textbackslash{}
\begin{DoxyEnumerate}
\item Connect to chisel ethernet network.\textbackslash{}
\item Ping 192.\+168.\+3.\+102 to verify connection.\textbackslash{}
\item Open V\+NC viewer and connect to chisel (password\+: chiselbot).
\end{DoxyEnumerate}
\item Attach checkerboard attachment to end-\/effector. ~\newline
$\ast$ In bot\+\_\+common\+\_\+ros/launch/camera\+\_\+calibration\+\_\+new.\+launch set use1/2/3/4 to true and others to false depending on which camera we are calibrating.\textbackslash{}
\item run {\ttfamily roslaunch bot\+\_\+common\+\_\+ros camera\+\_\+calibration\+\_\+new.\+launch}
\item Adjust the end effector using V\+NC so that the checkerboard is completely in the F\+OV of the camera.
\item run {\ttfamily rosrun tuw\+\_\+checkerboard tuw\+\_\+checkerboard\+\_\+node image\+:=/camera\+\_\+01/rgb/image\+\_\+raw camera\+\_\+info\+:=/camera\+\_\+01/rgb/camera\+\_\+info} adjusting for the specific camera number
\item Check the image to ensure checkerboard were successfully found.
\item run {\ttfamily rosrun dynamic\+\_\+reconfigure dynparam set /tuw\+\_\+checkerboard checkerboard\+\_\+square\+\_\+size 0.\+024} to set the square size
\item If the camera image is rotated (check by looking at the axes of T\+CP and checkerboard frame in rviz), then run {\ttfamily rosrun dynamic\+\_\+reconfigure dynparam set /tuw\+\_\+checkerboard rotate\+\_\+camera\+\_\+image\+\_\+180 true} to rotate by 180 degrees.
\item Set the rosparam values between checkerboard and nominal T\+CP such that the axes of checkerboard in R\+V\+IZ align with the tuw image. Also verify that the chisel T\+CP coincides with the checkerboard.
\item Load the params files (containing the fixed extrinsics T\+CP to base) by running the following\+:\textbackslash{}
\begin{DoxyEnumerate}
\item {\ttfamily roscd bot\+\_\+common\+\_\+ros/config/params}\textbackslash{}
\item {\ttfamily rosparam load arm\+\_\+params.\+yaml}\textbackslash{}
\item {\ttfamily rosparam load transform\+\_\+params.\+yaml}
\end{DoxyEnumerate}
\item run {\ttfamily rosrun bot\+\_\+common\+\_\+ros ur10\+\_\+driver.\+py \+\_\+input\+\_\+param\+\_\+path\+:=/ur10\+\_\+driver/arm\+\_\+2\+\_\+chisel/params \+\_\+dry\+\_\+run\+:=False}
\item In arm params edit arm/name in checkerboard calibration depending on whether the cameras are wrt saw base or chisel base checkerboard\+\_\+calibration\+:\textbackslash{} arm\+:\textbackslash{} id\+: 1\textbackslash{} name\+: \char`\"{}/chisel\char`\"{}\textbackslash{} T\+CP\+: \mbox{[}-\/0.\+084, 0.\+06, 0.\+025, 0.\+0, 0.\+0, -\/1.\+57\mbox{]} \# position and orientation of T\+CP w.\+r.\+t. Nominal-\/\+T\+CP\textbackslash{} mass\+: 0.\+0\textbackslash{} CG\+: \mbox{[}0.\+0, 0.\+0, 0.\+0\mbox{]} \# center of gravity in m of end-\/effector
\item run {\ttfamily rosrun tf tf\+\_\+echo \char`\"{}saw\+\_\+base\char`\"{} \char`\"{}camera\+\_\+04\+\_\+link\char`\"{}} with the correct \char`\"{}base\char`\"{} and \char`\"{}camera\+\_\+number\char`\"{}
\end{DoxyItemize}

$<$!--- Commented out toby\textquotesingle{}s lines for now $<$run \`{}camera\+\_\+auto\+\_\+calibration.sh \mbox{[}camera\+\_\+id\mbox{]}\`{}, don\textquotesingle{}t forget the leading \`{}0\`{} \#copy the translation and quaternion of output of form 
\begin{DoxyCode}{0}
\DoxyCodeLine{-\/-\/>}
\DoxyCodeLine{* Expected Output:}
\end{DoxyCode}
 At time 1253924111.\+082
\begin{DoxyItemize}
\item Translation\+: \mbox{[}-\/1.\+989, 0.\+151, 0.\+000\mbox{]}
\item Rotation\+: in Quaternion \mbox{[}0.\+000, 0.\+000, -\/0.\+046, 0.\+999\mbox{]} in R\+PY \mbox{[}0.\+000, -\/0.\+000, -\/0.\+092\mbox{]} 
\begin{DoxyCode}{0}
\DoxyCodeLine{* Copy and paste the values into `camera\_calibration.yaml` file.}
\DoxyCodeLine{}
\DoxyCodeLine{<!-\/-\/into the corresponding values of `camera\_calibration.yaml` file.-\/-\/>}
\DoxyCodeLine{}
\DoxyCodeLine{\#\#\#\# Load calibrated camera parameters}
\DoxyCodeLine{TODO: finalize this, it's not quite right  }
\DoxyCodeLine{Add the following code to your launch file}
\end{DoxyCode}
 $<$arg name=\char`\"{}device\+\_\+1\+\_\+prefix\char`\"{} default=\char`\"{}01\char`\"{}$>$ $<$rosparam command=\char`\"{}load\char`\"{} file=\char`\"{}\$(find bot\+\_\+common\+\_\+ros)/config/params/camera\+\_\+calibration.\+yaml\char`\"{}$>$ $<$node pkg=\char`\"{}tf\char`\"{} type=\char`\"{}static\+\_\+transform\+\_\+publisher\char`\"{} name=\char`\"{}camera\+\_\+broadcaster1\char`\"{} args=\char`\"{}x y z qx qy qz qw base camera\+\_\+0\$(arg device\+\_\+1\+\_\+prefix) 100\char`\"{}$>$ 
\begin{DoxyCode}{0}
\DoxyCodeLine{\# Testing}
\DoxyCodeLine{}
\DoxyCodeLine{\#\# test ur10\_driver}
\DoxyCodeLine{load rosparams from command line in the tests directory}
\end{DoxyCode}
 roscd bot\+\_\+common\+\_\+ros/tests rosparam load test\+\_\+params.\+yaml \`{}\`{}\`{} command line run, specifying if it\textquotesingle{}s in sim and if using api ~\newline
{\ttfamily rosrun bot\+\_\+common\+\_\+ros ur10\+\_\+driver.\+py \+\_\+input\+\_\+param\+\_\+path\+:=/ur10\+\_\+driver/arm\+\_\+1/params \+\_\+dry\+\_\+run\+:=False \+\_\+run\+\_\+test\+:=True \+\_\+run\+\_\+api\+:=True \+\_\+sim\+:=True}
\end{DoxyItemize}\hypertarget{autotoc_md6_autotoc_md10}{}\doxysection{Run ur10\+\_\+driver server}\label{autotoc_md6_autotoc_md10}
load rosparams from command line in the tests directory 
\begin{DoxyCode}{0}
\DoxyCodeLine{roscd bot\_common\_ros/tests}
\DoxyCodeLine{rosparam load test\_params.yaml}
\end{DoxyCode}
 command line run, specifying if it\textquotesingle{}s in sim and if using api ~\newline
{\ttfamily rosrun bot\+\_\+common\+\_\+ros ur10\+\_\+driver.\+py \+\_\+input\+\_\+param\+\_\+path\+:=/ur10\+\_\+driver/arm\+\_\+1/params \+\_\+dry\+\_\+run\+:=False}\hypertarget{autotoc_md6_autotoc_md11}{}\doxysection{Run robo-\/saw-\/action-\/server}\label{autotoc_md6_autotoc_md11}
Remember to fill the inputs correctly; whether it\textquotesingle{}s in sim, whether to run the arm-\/client as an api, input ros-\/topics. ~\newline

\begin{DoxyCode}{0}
\DoxyCodeLine{cd \$OFFWORLD\_ROOT/Code/offworld-\/ur/Chiseling\(\backslash\) Baselines}
\DoxyCodeLine{python robo\_saw\_action\_server.py \_sim:=True \_client\_topic:=/test\_ur10\_driver/arm \_input\_param\_path:=/ur10\_driver/arm\_1/params \_run\_api:=False}
\end{DoxyCode}
 